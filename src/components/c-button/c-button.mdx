import { Meta, Canvas, Controls } from '@storybook/addon-docs/blocks';
import * as ButtonStories from './c-button.stories';

<Meta of={ButtonStories} />

# Button (`c-button`)

`c-button` は、アクションを実行するためのインタラクティブな要素です。
**CSS `if()` 関数**を使用して、バリアントやサイズを制御します。

## 🎉 新しい設計

CSS `if()` 関数の採用により、以前の設計で必要だった**ラッパー要素が不要**になりました。

```html
<!-- ✅ 新しい構造（シンプル！） -->
<button class="c-button" type="button">Button</button>

<!-- ❌ 以前の構造（ラッパーが必要だった） -->
<div class="c-button">
  <button type="button">Button</button>
</div>
```

## Public API (CSS Variables)

このコンポーネントは以下のCSS変数を公開しており、外部からカスタマイズ可能です。

### コンテキスト変数（`if()` による条件分岐）

| 変数名      | 値                             | 説明                       |
| :---------- | :----------------------------- | :------------------------- |
| `--variant` | `primary` \| `secondary`       | ボタンのスタイルバリアント |
| `--size`    | `small` \| `medium` \| `large` | ボタンのサイズ             |

### カスタマイズ変数

| 変数名                       | デフォルト値                 | 説明                       |
| :--------------------------- | :--------------------------- | :------------------------- |
| `--c-button-font-family`     | `var(--sys-font-body)`       | フォントファミリー         |
| `--c-button-font-weight`     | `600`                        | フォントウェイト           |
| `--c-button-border-radius`   | `3em`                        | ボーダーの角丸             |
| `--c-button-transition`      | `all 0.2s ease-in-out`       | トランジション             |
| `--c-button-color`           | `var(--sys-text-inverse)`    | テキストカラー             |
| `--c-button-bg`              | `var(--sys-bg-action)`       | 背景色                     |
| `--c-button-shadow`          | `var(--sys-elevation-base)`  | ボックスシャドウ           |
| `--c-button-bg-hover`        | `var(--sys-bg-action-hover)` | ホバー時の背景色           |
| `--c-button-shadow-hover`    | `var(--sys-elevation-md)`    | ホバー時のシャドウ         |
| `--c-button-transform-hover` | `translateY(-2px)`           | ホバー時のトランスフォーム |

## 使用例

### 基本

<Canvas of={ButtonStories.Default} />

<Controls of={ButtonStories.Default} />

### Primary

デフォルトのスタイル。主要なアクションに使用します。
`--variant` と `--size` はデフォルト値（primary, medium）の場合、省略可能です。

```html
<button class="c-button" type="button">Button</button>
```

<Canvas of={ButtonStories.Primary} />

### Secondary

二次的なアクションや、Primaryボタンと並べて使用する場合に適しています。

```html
<button class="c-button" style="--variant: secondary" type="button">Button</button>
```

<Canvas of={ButtonStories.Secondary} />

## サイズバリエーション

### Small

```html
<button class="c-button" style="--size: small" type="button">Button</button>
```

<Canvas of={ButtonStories.Small} />

### Medium

```html
<button class="c-button" type="button">Button</button>
```

<Canvas of={ButtonStories.Medium} />

### Large

```html
<button class="c-button" style="--size: large" type="button">Button</button>
```

<Canvas of={ButtonStories.Large} />

## 状態

### Disabled

```html
<button class="c-button" type="button" disabled>Button</button>
```

<Canvas of={ButtonStories.Disabled} />

## コンテキストベースのスタイリング

CSS変数は継承されるため、親コンポーネントで `--variant` を設定すると、子の `c-button` が自動的に適応します。

```html
<div style="--variant: secondary">
	<!-- この中のボタンは自動的にsecondaryスタイルになる -->
	<button class="c-button" type="button">Button</button>
</div>
```

<Canvas of={ButtonStories.ContextInheritance} />

## 設計思想

このコンポーネントは「APIとしてのCSS」の設計思想に基づいています。

### CSS `if()` 関数の活用

従来の Style Queries（`@container style(...)`）には「コンテナ自身には適用されない」という制約がありました。
CSS `if()` 関数を使用することで、この制約を回避し、**button要素を直接コンポーネントルートに**できるようになりました。

```css
.c-button {
	/* if() で variant に応じた値を決定 */
	--_bg: if(
		style(--variant: secondary): transparent;
		else: var(--sys-bg-action)
	);

	background: var(--_bg);
}
```

### 利点

1. **セマンティックなHTML**: 余分なラッパー要素が不要
2. **コンテキスト継承**: CSS変数の継承により、親から子へのスタイル伝播が可能
3. **カプセル化**: プライベート変数（`--_`プレフィックス）で内部実装を隠蔽

### ブラウザサポート

CSS `if()` 関数は **Chrome 137+**（2025年6月〜）でサポートされています。

```css
/* サポート状況（2025年時点） */
/* Chrome 137+  ✅ */
/* Firefox      🔄 実装中 */
/* Safari       ❌ 未実装 */
```

> **Note**: このプロジェクトは「理想的なCSS設計」を追求する実験的なカタログです。
> プロダクション環境では、ブラウザサポートを考慮した判断が必要です。
