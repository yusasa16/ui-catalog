import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Docs/Design Tokens" />

# デザイン・トークン哲学

このドキュメントは、このプロジェクトにおけるデザイン・トークンのアーキテクチャ上の決定と分類法を概説します。
私たちの目標は、デザインとエンジニアリングの橋渡しをする共有語彙を確立し、独自のツールに依存することなく一貫性とスケーラビリティを確保することです。

## コアアーキテクチャ：3層システム

私たちは、**値**と**意図**を分離するために、標準的な3層トークンアーキテクチャを採用しています。

### 1. プリミティブトークン（参照）

- **プレフィックス**: `--ref-`
- **定義**: 一般的な名前を持つ生の値（Hex, px, rem）。
- **役割**: 利用可能なオプションの「パレット」。
- **ルール**: コンポーネント内でこれらを直接使用することは**絶対に**避けてください。
  - **例外**: スペーシングトークン（`--ref-space-*`）は、空間グリッド自体がシステムレベルの契約であるため、直接使用しても構いません。
- **命名パターン**: `--ref-{category}-{scale/name}`
  - `--ref-color-blue-500`: `#3b82f6`
  - `--ref-space-4`: `16px`

### 2. セマンティックトークン（システム）

- **プレフィックス**: `--sys-`
- **定義**: **意図**または**コンテキスト**を記述するプリミティブへの参照。
- **役割**: デザインシステムの「契約」または「API」。ここでテーマ設定（ダークモード）が行われます。
- **ルール**: UI要素の見た目を定義するためにこれらを使用してください。
- **命名パターン**: `--sys-{property}-{OBJECT}-{INTENT}`

#### 分類法：オブジェクト x 意図

「モノ」（Surface, Text）と「状態」（Action, Success）の混同を避けるため、すべてのセマンティックトークンは**オブジェクト**と**意図**の交差点です。

**1. オブジェクト（キャンバス）**

- **`bg`**: 背景とサーフェス。
- **`text`**: テキストとアイコン（塗りつぶし）。
- **`border`**: ストロークとアウトライン。
- **`elevation`**: 影と奥行き。
- **`font`**: タイポグラフィファミリー。

**2. 意図（コンテキスト）**

- **階層**: `base`（基盤）、`surface`（カード）、`main`（主要コンテンツ）、`muted`（二次的）。
- **インタラクション**: `action`（インタラクティブ要素）。
- **フィードバック**: `info`、`success`、`warning`、`error`。

**マッピング例**:

| 変数                   | オブジェクト | 意図   | 使用法           |
| :--------------------- | :----------- | :----- | :--------------- |
| `--sys-bg-base`        | Background   | Base   | ページの背景     |
| `--sys-bg-action`      | Background   | Action | ボタンの背景     |
| `--sys-text-main`      | Text         | Main   | 見出し           |
| `--sys-text-action`    | Text         | Action | ボタンのテキスト |
| `--sys-elevation-base` | Elevation    | Base   | ボタンの影       |

### 3. コンポーネントトークン（スコープ付き）

私たちは、カプセル化を確保しながら制御されたカスタマイズを可能にするために、**パブリック/プライベートAPIパターン**（[CSS Custom Properties as APIs](https://weidesign.engineer/blog/css-architecture-api-pattern/)に触発された）を採用しています。

#### 3.1. プライベート変数（実装）

- **プレフィックス**: `--_`（アンダースコア）
- **定義**: コンポーネントのスタイル設定に使用される内部変数。
- **役割**: カプセル化。コンポーネントの外部からこれらを設定または読み取ることは**絶対に**避けてください。
- **命名パターン**: `--_{property}`（簡潔さのためにコンポーネント名は省略されます）

#### 3.2. パブリック変数（API）

- **プレフィックス**: `--{component}-{property}`
- **定義**: カスタマイズのために公開されるパブリックインターフェース。
- **役割**: カスタマイズ。外部からコンポーネントスタイルをオーバーライドするためにこれらを使用してください。
- **命名パターン**: `--c-button-bg`, `--l-grid-gap`

#### 3.3. パターン：フォールバックチェーン

コンポーネントは、最初にパブリックAPI変数をチェックし、次にセマンティックトークン（デフォルト）にフォールバックすることで、プライベート変数を明示的に初期化する必要があります。

```css
.c-button {
	/* プライベート変数 = パブリックAPI（設定されている場合） ?? システムトークン（デフォルト） */
	--_bg: var(--c-button-bg, var(--sys-bg-action));

	/* 実装はプライベート変数を使用 */
	background: var(--_bg);
}
```

この構造により、以下が保証されます：

1.  **カプセル化**: 内部ロジック（`--_bg`）は外部入力から分離されています。
2.  **カスタマイズ性**: コンシューマーは、詳細度と戦うことなく、`--c-button-bg` を設定して色をオーバーライドできます。
3.  **安全性**: オーバーライドが提供されない場合、システムトークンが安全なデフォルトとして使用されます。

---

## ディスカッショントピック

### 1. トークンカバレッジ

どのプロパティをトークン化すべきか？

- [ ] Radius（角の丸み）
- [x] Shadow（Elevation） -> `--sys-elevation-*` にマップ済み
- [ ] Z-Index（レイヤリング）
- [ ] Animation（期間、イージング）

---

## ドラフト：トークンマップ（作業中）

### プリミティブ（参照）

```css
:root {
	/* Colors */
	--ref-color-white: #ffffff;
	--ref-color-gray-50: #f9fafb;
	--ref-color-gray-100: #f3f4f6;
	--ref-color-gray-900: #111827;
	--ref-color-blue-500: #3b82f6;

	/* Spacing (4px grid) */
	--ref-space-1: 4px;
	--ref-space-2: 8px;
	--ref-space-4: 16px;
	--ref-space-8: 32px;
}
```

### セマンティクス（システム）

```css
:root {
	/* Surfaces */
	--sys-bg-base: var(--ref-color-gray-50);
	--sys-bg-surface: var(--ref-color-white);
	--sys-bg-muted: var(--ref-color-gray-100);

	/* Text */
	--sys-text-main: var(--ref-color-gray-900);

	/* Actions */
	--sys-bg-action: var(--ref-color-blue-500);

	/* Elevation */
	--sys-elevation-base: var(--ref-shadow-md);
}
```
